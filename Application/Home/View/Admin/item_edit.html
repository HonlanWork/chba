<style>
#main input.value {
    color: #333;
    display: inline-block;
    width: 400px;
    padding-left: 89px;
}

#main span.key {
    width: 70px;
    display: inline-block;
    margin-right: -74px;
}

textarea.form-control {
    background-color: transparent;
    border-color: #333;
    box-shadow: none;
    border-top: none;
    border-left: none;
    border-right: none;
    border-radius: 0;
    width: 400px;
    color: #333;
    margin-top: 6px;
    margin-bottom: 10px;
    resize: none;
}

textarea.form-control:focus {
    border-color: #333;
    box-shadow: none;
}
</style>
<script src="__PUBLIC__/js/lrz.bundle.js"></script>
<div class="my_container">
    <h5>编辑拍品</h5>
    <form action="{:U('Admin/item_edit_handle')}" method="post" style="color:#333;margin-top:10px;">
        <input type="text" name="id" value="{$item['id']}" style="display:none;">
        <div>
            <span class="key">拍品序号</span>
            <input type="text" class="form-control value" name="number" value="{$item['number']}">
        </div>
        <div>
            <span class="key">拍品名称</span>
            <input type="text" class="form-control value" name="title" value="{$item['title']}">
        </div>
        <div>
            <span class="key">起拍价</span>
            <input type="text" class="form-control value" name="start" value="{$item['start']}">
        </div>
        <div>
            <span class="key">每次加价</span>
            <input type="text" class="form-control value" name="step" value="{$item['step']}">
        </div>
        <div>
            <span class="key">拍品数量</span>
            <input type="text" class="form-control value" name="amount" value="{$item['amount']}">
        </div>
        <div>
            <span class="key">捐赠者</span>
            <input type="text" class="form-control value" name="donator" value="{$item['donator']}">
        </div>
        <div style="margin-top:12px;">
            <span class="key">拍品介绍</span>
            <textarea name="description" class="form-control" cols="30" rows="10">{$item['description']}</textarea>
        </div>
        <div style="margin-top:12px;">
            <span class="key">捐赠者介绍</span>
            <textarea name="donatorDesc" class="form-control" cols="30" rows="10">{$item['donatorDesc']}</textarea>
        </div>
        <div style="margin-top:20px;" class="row" id="images">
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-3">
                <div style="position:relative;width:100%;margin-bottom:15px;">
                    <p style="width:100%;text-align:center;border-radius:3px;border:1px solid #ddd;color:#666;background-color:#F4F4F4;position:relative;">
                        <if condition="$item['image1'] eq ''">
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;"></span>
                            <img src="" alt="" name="image11" style="width:100%;height:auto;display:none;border-radius:3px;">
                            <button name="image11" style="display:none;z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                            <else/>
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;display:none;"></span>
                            <img src="__PUBLIC__{$item['image1']}" alt="" name="image11" style="width:100%;height:auto;border-radius:3px;">
                            <button name="image11" style="z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                        </if>
                    </p>
                    <input type="file" accept="image/*" style="opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;cursor:pointer;" name="image1" capture="camera">
                    <input type="text" name="image11" value="" style="display:none;">
                </div>
                <div style="position:relative;width:100%;margin-bottom:15px;">
                    <p style="width:100%;text-align:center;border-radius:3px;border:1px solid #ddd;color:#666;background-color:#F4F4F4;position:relative;">
                        <if condition="$item['image2'] eq ''">
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;"></span>
                            <img src="" alt="" name="image22" style="width:100%;height:auto;display:none;border-radius:3px;">
                            <button name="image22" style="display:none;z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                            <else/>
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;display:none;"></span>
                            <img src="__PUBLIC__{$item['image2']}" alt="" name="image22" style="width:100%;height:auto;border-radius:3px;">
                            <button name="image22" style="z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                        </if>
                    </p>
                    <input type="file" accept="image/*" style="opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;cursor:pointer;" name="image2" capture="camera">
                    <input type="text" name="image22" value="" style="display:none;">
                </div>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-3">
                <div style="position:relative;width:100%;margin-bottom:15px;">
                    <p style="width:100%;text-align:center;border-radius:3px;border:1px solid #ddd;color:#666;background-color:#F4F4F4;position:relative;">
                        <if condition="$item['image3'] eq ''">
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;"></span>
                            <img src="" alt="" name="image33" style="width:100%;height:auto;display:none;border-radius:3px;">
                            <button name="image33" style="display:none;z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                            <else/>
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;display:none;"></span>
                            <img src="__PUBLIC__{$item['image3']}" alt="" name="image33" style="width:100%;height:auto;border-radius:3px;">
                            <button name="image33" style="z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                        </if>
                    </p>
                    <input type="file" accept="image/*" style="opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;cursor:pointer;" name="image3" capture="camera">
                    <input type="text" name="image33" value="" style="display:none;">
                </div>
                <div style="position:relative;width:100%;margin-bottom:15px;">
                    <p style="width:100%;text-align:center;border-radius:3px;border:1px solid #ddd;color:#666;background-color:#F4F4F4;position:relative;">
                        <if condition="$item['image4'] eq ''">
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;"></span>
                            <img src="" alt="" name="image44" style="width:100%;height:auto;display:none;border-radius:3px;">
                            <button name="image44" style="display:none;z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                            <else/>
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;display:none;"></span>
                            <img src="__PUBLIC__{$item['image4']}" alt="" name="image44" style="width:100%;height:auto;border-radius:3px;">
                            <button name="image44" style="z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                        </if>
                    </p>
                    <input type="file" accept="image/*" style="opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;cursor:pointer;" name="image4" capture="camera">
                    <input type="text" name="image44" value="" style="display:none;">
                </div>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-3 col-lg-3">
                <div style="position:relative;width:100%;margin-bottom:15px;">
                    <p style="width:100%;text-align:center;border-radius:3px;border:1px solid #ddd;color:#666;background-color:#F4F4F4;position:relative;">
                        <if condition="$item['image5'] eq ''">
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;"></span>
                            <img src="" alt="" name="image55" style="width:100%;height:auto;display:none;border-radius:3px;">
                            <button name="image55" style="display:none;z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                            <else/>
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;display:none;"></span>
                            <img src="__PUBLIC__{$item['image5']}" alt="" name="image55" style="width:100%;height:auto;border-radius:3px;">
                            <button name="image55" style="z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                        </if>
                    </p>
                    <input type="file" accept="image/*" style="opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;cursor:pointer;" name="image5" capture="camera">
                    <input type="text" name="image55" value="" style="display:none;">
                </div>
                <div style="position:relative;width:100%;margin-bottom:15px;">
                    <p style="width:100%;text-align:center;border-radius:3px;border:1px solid #ddd;color:#666;background-color:#F4F4F4;position:relative;">
                        <if condition="$item['image6'] eq ''">
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;"></span>
                            <img src="" alt="" name="image66" style="width:100%;height:auto;display:none;border-radius:3px;">
                            <button name="image66" style="display:none;z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                            <else/>
                            <span class="fa fa-fw fa-file-image-o" style="color:#ccc;font-size:40px;padding-top:20px;padding-bottom:20px;display:none;"></span>
                            <img src="__PUBLIC__{$item['image6']}" alt="" name="image66" style="width:100%;height:auto;border-radius:3px;">
                            <button name="image66" style="z-index:999;position:absolute;top:5px;right:5px;font-size:16px;border-radius:50%;width:28px;border:none;color:#fff;background-color:rgba(20,20,20,0.8);"><span>x</span></button>
                        </if>
                    </p>
                    <input type="file" accept="image/*" style="opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;cursor:pointer;" name="image6" capture="camera">
                    <input type="text" name="image66" value="" style="display:none;">
                </div>
            </div>
        </div>
        <button type="submit" class="btn btn-default" style="margin-top:5px;">保存</button>
    </form>
</div>
<script>
$(document).ready(function() {
    $('#main #images input').change(function() {
        $(this).siblings('p').append("<span class='fa fa-fw fa-spin fa-spinner' style='position:absolute;top:10px;left:10px;font-size:18px;color:#666;'></span>");
        var image;
        var id = $(this).attr('name');
        console.log(id);
        lrz($(this)[0].files[0], {
                width: 800,
                height: 800,
                quality: 0.8
            })
            .then(function(rst) {
                image = rst.base64;
                console.log('111111');
                $('#main img[name="' + id + id.substr(id.length - 1) + '"]').attr('src', image);
                $('#main img[name="' + id + id.substr(id.length - 1) + '"]').siblings('span.fa-file-image-o').hide();
                $('#main img[name="' + id + id.substr(id.length - 1) + '"]').show();
                $('#main button[name="' + id + id.substr(id.length - 1) + '"]').show();
                $('#main input[name="' + id + id.substr(id.length - 1) + '"]').val(image);
                $('#main span.fa-spinner').remove();
            })
            .catch(function(err) {
                // 处理失败会执行
            })
            .always(function() {
                // 不管是成功失败，都会执行
            });
    });
    $('#main #images button').click(function(event) {
        event.preventDefault();
        var id = $(this).attr('name');
        $('#main input[name="' + id + '"]').val('remove');
        $('#main img[name="' + id + '"]').hide();
        $('#main button[name="' + id + '"]').hide();
        $('#main img[name="' + id + '"]').siblings('span.fa-file-image-o').show();
        $('#main input[name="' + id.substr(0, id.length - 1) + '"]').val('');
    });
});
</script>